<modification>
	<id><![CDATA[Improved Order Management - Proper IP Blacklist Handling Of Orders]]></id>
	<version>1.0.0</version>
	<vqmver>2.1.6</vqmver>
	<author>Jeff Hunter aka Tcalp</author>

		<file name="admin/controller/setting/setting.php">
			<operation> <!-- READ LANGUAGE FOR GLOBAL SETTINGS -->
				<search position="before"><![CDATA[$this->data['entry_logo']]]></search>
				<add><![CDATA[$this->data['entry_blacklist_status'] = $this->language->get('entry_blacklist_status');]]></add>
			</operation>
			<operation> <!-- READ FORM / DATA -->
				<search position="before"><![CDATA[isset($this->request->post['config_name'])]]></search>
				<add><![CDATA[
			if (isset($this->request->post['config_blacklist_status_id'])) {
				$this->data['config_blacklist_status_id'] = $this->request->post['config_blacklist_status_id'];
			} elseif ($this->config->get('config_blacklist_status_id')) {
				$this->data['config_blacklist_status_id'] = $this->config->get('config_blacklist_status_id');
			} else {
				$this->data['config_blacklist_status_id'] = 0;
			}
				]]></add>
			</operation>
		</file>

		<file name="admin/view/template/setting/setting.tpl">
			<operation> <!-- ADD LANGUAGE ENTRIES FOR STORE SETTINGS -->
				<search position="before" offset="1"><![CDATA[<?php echo $entry_order_status; ?>]]></search>
				<add><![CDATA[
            <tr>
              <td><?php echo $entry_blacklist_status; ?></td>
              <td><select name="config_blacklist_status_id">
                  <?php foreach ($order_statuses as $order_status) { ?>
                  <?php if ($order_status['order_status_id'] == $config_blacklist_status_id) { ?>
                  <option value="<?php echo $order_status['order_status_id']; ?>" selected="selected"><?php echo $order_status['name']; ?></option>
                  <?php } else { ?>
                  <option value="<?php echo $order_status['order_status_id']; ?>"><?php echo $order_status['name']; ?></option>
                  <?php } ?>
                  <?php } ?>
                </select></td>
            </tr>
			]]></add>
			</operation>
		</file>

		<file name="admin/language/*/setting/setting.php">
			<operation> <!-- ADD LANGUAGE ENTRIES FOR STORE SETTINGS -->
				<search position="after"><![CDATA[?php]]></search>
				<add><![CDATA[$_['entry_blacklist_status'] = 'Blacklisted Order Status:<br /><span class="help">Orders being placed from a blacklisted IP will be assigned this status so that they do not reach processing or completed status automatically.';]]></add>
			</operation>
		</file>			

		<!--<file name="catalog/model/checkout/order.php">
			<operation> 
				<search position="replace"><![CDATA[$order_status_id = $this->config->get('config_order_status_id');]]></search>
				<add><![CDATA[$order_status_id = $this->config->get('config_blacklist_status_id');]]></add>
			</operation>
		</file>-->
					
		
</modification>